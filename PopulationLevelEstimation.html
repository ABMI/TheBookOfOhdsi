<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Population-level estimation | The Book of OHDSI</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.11.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Population-level estimation | The Book of OHDSI" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://ohdsi.github.io/TheBookOfOhdsi/" />
  <meta property="og:image" content="https://ohdsi.github.io/TheBookOfOhdsi/images/Cover/Cover.png" />
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="OHDSI/TheBookOfOhdsi" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Population-level estimation | The Book of OHDSI" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="twitter:image" content="https://ohdsi.github.io/TheBookOfOhdsi/images/Cover/Cover.png" />

<meta name="author" content="Observational Health Data Science and Informatics" />


<meta name="date" content="2019-06-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="Characterization.html">
<link rel="next" href="PatientLevelPrediction.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-104086677-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-104086677-2');
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The Book of OHDSI</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#goals-of-this-book"><i class="fa fa-check"></i>Goals of this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure-of-the-book"><i class="fa fa-check"></i>Structure of the book</a></li>
</ul></li>
<li class="part"><span><b>I The OHDSI Community</b></span></li>
<li class="chapter" data-level="1" data-path="MissionVissionValues.html"><a href="MissionVissionValues.html"><i class="fa fa-check"></i><b>1</b> Mission, vision, values</a><ul>
<li class="chapter" data-level="1.1" data-path="MissionVissionValues.html"><a href="MissionVissionValues.html#our-mission"><i class="fa fa-check"></i><b>1.1</b> Our Mission</a></li>
<li class="chapter" data-level="1.2" data-path="MissionVissionValues.html"><a href="MissionVissionValues.html#our-vision"><i class="fa fa-check"></i><b>1.2</b> Our Vision</a></li>
<li class="chapter" data-level="1.3" data-path="MissionVissionValues.html"><a href="MissionVissionValues.html#our-objectives"><i class="fa fa-check"></i><b>1.3</b> Our Objectives</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Collaborators.html"><a href="Collaborators.html"><i class="fa fa-check"></i><b>2</b> Collaborators</a></li>
<li class="chapter" data-level="3" data-path="OpenScience.html"><a href="OpenScience.html"><i class="fa fa-check"></i><b>3</b> Open Science</a></li>
<li class="chapter" data-level="4" data-path="WhereToBegin.html"><a href="WhereToBegin.html"><i class="fa fa-check"></i><b>4</b> Where to begin</a></li>
<li class="part"><span><b>II Uniform Data Representation</b></span></li>
<li class="chapter" data-level="5" data-path="CommonDataModel.html"><a href="CommonDataModel.html"><i class="fa fa-check"></i><b>5</b> The Common Data Model</a><ul>
<li class="chapter" data-level="5.1" data-path="CommonDataModel.html"><a href="CommonDataModel.html#design-principles"><i class="fa fa-check"></i><b>5.1</b> Design Principles</a></li>
<li class="chapter" data-level="5.2" data-path="CommonDataModel.html"><a href="CommonDataModel.html#data-model-conventions"><i class="fa fa-check"></i><b>5.2</b> Data Model Conventions</a><ul>
<li class="chapter" data-level="5.2.1" data-path="CommonDataModel.html"><a href="CommonDataModel.html#model-conv"><i class="fa fa-check"></i><b>5.2.1</b> General conventions of the model</a></li>
<li class="chapter" data-level="5.2.2" data-path="CommonDataModel.html"><a href="CommonDataModel.html#general-conventions-of-schemas"><i class="fa fa-check"></i><b>5.2.2</b> General conventions of schemas</a></li>
<li class="chapter" data-level="5.2.3" data-path="CommonDataModel.html"><a href="CommonDataModel.html#general-conventions-of-data-tables"><i class="fa fa-check"></i><b>5.2.3</b> General conventions of data tables</a></li>
<li class="chapter" data-level="5.2.4" data-path="CommonDataModel.html"><a href="CommonDataModel.html#general-conventions-of-fields"><i class="fa fa-check"></i><b>5.2.4</b> General conventions of fields</a></li>
<li class="chapter" data-level="5.2.5" data-path="CommonDataModel.html"><a href="CommonDataModel.html#representation-of-content-through-concepts"><i class="fa fa-check"></i><b>5.2.5</b> Representation of content through Concepts</a></li>
<li class="chapter" data-level="5.2.6" data-path="CommonDataModel.html"><a href="CommonDataModel.html#difference-between-concept-ids-and-source-values"><i class="fa fa-check"></i><b>5.2.6</b> Difference between Concept IDs and Source Values</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="CommonDataModel.html"><a href="CommonDataModel.html#omop-cdm-standardized-tables"><i class="fa fa-check"></i><b>5.3</b> OMOP CDM Standardized Tables</a><ul>
<li class="chapter" data-level="5.3.1" data-path="CommonDataModel.html"><a href="CommonDataModel.html#running-example-endometriosis"><i class="fa fa-check"></i><b>5.3.1</b> Running Example: Endometriosis</a></li>
<li class="chapter" data-level="5.3.2" data-path="CommonDataModel.html"><a href="CommonDataModel.html#person"><i class="fa fa-check"></i><b>5.3.2</b> PERSON table</a></li>
<li class="chapter" data-level="5.3.3" data-path="CommonDataModel.html"><a href="CommonDataModel.html#observationPeriod"><i class="fa fa-check"></i><b>5.3.3</b> OBSERVATION_PERIOD table</a></li>
<li class="chapter" data-level="5.3.4" data-path="CommonDataModel.html"><a href="CommonDataModel.html#visitOccurrence"><i class="fa fa-check"></i><b>5.3.4</b> VISIT_OCCURRENCE</a></li>
<li class="chapter" data-level="5.3.5" data-path="CommonDataModel.html"><a href="CommonDataModel.html#conditionOccurrence"><i class="fa fa-check"></i><b>5.3.5</b> CONDITION_OCCURRENCE</a></li>
<li class="chapter" data-level="5.3.6" data-path="CommonDataModel.html"><a href="CommonDataModel.html#drugExposure"><i class="fa fa-check"></i><b>5.3.6</b> DRUG_EXPOSURE</a></li>
<li class="chapter" data-level="5.3.7" data-path="CommonDataModel.html"><a href="CommonDataModel.html#procedureOccurrence"><i class="fa fa-check"></i><b>5.3.7</b> PROCEDURE_OCCURRENCE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="StandardizedVocabularies.html"><a href="StandardizedVocabularies.html"><i class="fa fa-check"></i><b>6</b> Standardized Vocabularies</a></li>
<li class="chapter" data-level="7" data-path="ExtractTransformLoad.html"><a href="ExtractTransformLoad.html"><i class="fa fa-check"></i><b>7</b> Extract Transform Load</a></li>
<li class="part"><span><b>III Data Analytics</b></span></li>
<li class="chapter" data-level="8" data-path="DataAnalyticsUseCases.html"><a href="DataAnalyticsUseCases.html"><i class="fa fa-check"></i><b>8</b> Data Analytics Use Cases</a></li>
<li class="chapter" data-level="9" data-path="OhdsiAnalyticsTools.html"><a href="OhdsiAnalyticsTools.html"><i class="fa fa-check"></i><b>9</b> OHDSI Analytics Tools</a></li>
<li class="chapter" data-level="10" data-path="SqlAndR.html"><a href="SqlAndR.html"><i class="fa fa-check"></i><b>10</b> SQL and R</a><ul>
<li class="chapter" data-level="10.1" data-path="SqlAndR.html"><a href="SqlAndR.html#SqlRender"><i class="fa fa-check"></i><b>10.1</b> SqlRender</a><ul>
<li class="chapter" data-level="10.1.1" data-path="SqlAndR.html"><a href="SqlAndR.html#sql-parameterization"><i class="fa fa-check"></i><b>10.1.1</b> SQL parameterization</a></li>
<li class="chapter" data-level="10.1.2" data-path="SqlAndR.html"><a href="SqlAndR.html#translation-to-other-sql-dialects"><i class="fa fa-check"></i><b>10.1.2</b> Translation to other SQL dialects</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="SqlAndR.html"><a href="SqlAndR.html#DatabaseConnector"><i class="fa fa-check"></i><b>10.2</b> DatabaseConnector</a><ul>
<li class="chapter" data-level="10.2.1" data-path="SqlAndR.html"><a href="SqlAndR.html#creating-a-connection"><i class="fa fa-check"></i><b>10.2.1</b> Creating a connection</a></li>
<li class="chapter" data-level="10.2.2" data-path="SqlAndR.html"><a href="SqlAndR.html#querying"><i class="fa fa-check"></i><b>10.2.2</b> Querying</a></li>
<li class="chapter" data-level="10.2.3" data-path="SqlAndR.html"><a href="SqlAndR.html#querying-using-ffdf-objects"><i class="fa fa-check"></i><b>10.2.3</b> Querying using ffdf objects</a></li>
<li class="chapter" data-level="10.2.4" data-path="SqlAndR.html"><a href="SqlAndR.html#querying-different-platforms-using-the-same-sql"><i class="fa fa-check"></i><b>10.2.4</b> Querying different platforms using the same SQL</a></li>
<li class="chapter" data-level="10.2.5" data-path="SqlAndR.html"><a href="SqlAndR.html#inserting-tables"><i class="fa fa-check"></i><b>10.2.5</b> Inserting tables</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="SqlAndR.html"><a href="SqlAndR.html#querying-the-cdm"><i class="fa fa-check"></i><b>10.3</b> Querying the CDM</a></li>
<li class="chapter" data-level="10.4" data-path="SqlAndR.html"><a href="SqlAndR.html#querying-the-vocabulary"><i class="fa fa-check"></i><b>10.4</b> Querying the vocabulary</a></li>
<li class="chapter" data-level="10.5" data-path="SqlAndR.html"><a href="SqlAndR.html#using-the-vocabulary-when-querying"><i class="fa fa-check"></i><b>10.5</b> Using the vocabulary when querying</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Cohorts.html"><a href="Cohorts.html"><i class="fa fa-check"></i><b>11</b> Building the building blocks: cohorts</a></li>
<li class="chapter" data-level="12" data-path="Characterization.html"><a href="Characterization.html"><i class="fa fa-check"></i><b>12</b> Characterization</a></li>
<li class="chapter" data-level="13" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html"><i class="fa fa-check"></i><b>13</b> Population-level estimation</a><ul>
<li class="chapter" data-level="13.1" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#study-designs"><i class="fa fa-check"></i><b>13.1</b> Study designs</a><ul>
<li class="chapter" data-level="13.1.1" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#cohort-method"><i class="fa fa-check"></i><b>13.1.1</b> Cohort method</a></li>
<li class="chapter" data-level="13.1.2" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#self-controlled-cohort"><i class="fa fa-check"></i><b>13.1.2</b> Self-controlled cohort</a></li>
<li class="chapter" data-level="13.1.3" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#case-control"><i class="fa fa-check"></i><b>13.1.3</b> Case-control</a></li>
<li class="chapter" data-level="13.1.4" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#case-crossover"><i class="fa fa-check"></i><b>13.1.4</b> Case-crossover</a></li>
<li class="chapter" data-level="13.1.5" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#self-controlled-case-series"><i class="fa fa-check"></i><b>13.1.5</b> Self-controlled case series</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#designing-a-hypertension-study"><i class="fa fa-check"></i><b>13.2</b> Designing a hypertension study</a><ul>
<li class="chapter" data-level="13.2.1" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#problem-definition"><i class="fa fa-check"></i><b>13.2.1</b> Problem definition</a></li>
<li class="chapter" data-level="13.2.2" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#target-and-comparator"><i class="fa fa-check"></i><b>13.2.2</b> Target and comparator</a></li>
<li class="chapter" data-level="13.2.3" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#outcome"><i class="fa fa-check"></i><b>13.2.3</b> Outcome</a></li>
<li class="chapter" data-level="13.2.4" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#time-at-risk"><i class="fa fa-check"></i><b>13.2.4</b> Time-at-risk</a></li>
<li class="chapter" data-level="13.2.5" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#model"><i class="fa fa-check"></i><b>13.2.5</b> Model</a></li>
<li class="chapter" data-level="13.2.6" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#study-summary"><i class="fa fa-check"></i><b>13.2.6</b> Study summary</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#implementation-the-study-using-atlas"><i class="fa fa-check"></i><b>13.3</b> Implementation the study using ATLAS</a><ul>
<li class="chapter" data-level="13.3.1" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#specifying-the-comparisons"><i class="fa fa-check"></i><b>13.3.1</b> Specifying the comparisons</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#implementation-the-study-using-r"><i class="fa fa-check"></i><b>13.4</b> Implementation the study using R</a><ul>
<li class="chapter" data-level="13.4.1" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#cohort-instantiation"><i class="fa fa-check"></i><b>13.4.1</b> Cohort instantiation</a></li>
<li class="chapter" data-level="13.4.2" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#data-extraction"><i class="fa fa-check"></i><b>13.4.2</b> Data extraction</a></li>
<li class="chapter" data-level="13.4.3" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#specifying-the-analyses"><i class="fa fa-check"></i><b>13.4.3</b> Specifying the analyses</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="PopulationLevelEstimation.html"><a href="PopulationLevelEstimation.html#excercises"><i class="fa fa-check"></i><b>13.5</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html"><i class="fa fa-check"></i><b>14</b> Patient Level Prediction</a><ul>
<li class="chapter" data-level="14.1" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#designing-a-hypertension-study-1"><i class="fa fa-check"></i><b>14.1</b> Designing a hypertension study</a><ul>
<li class="chapter" data-level="14.1.1" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#problem-definition-1"><i class="fa fa-check"></i><b>14.1.1</b> Problem definition</a></li>
<li class="chapter" data-level="14.1.2" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#study-population-definition"><i class="fa fa-check"></i><b>14.1.2</b> Study population definition</a></li>
<li class="chapter" data-level="14.1.3" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#model-development-settings"><i class="fa fa-check"></i><b>14.1.3</b> Model development settings</a></li>
<li class="chapter" data-level="14.1.4" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#model-evaluation"><i class="fa fa-check"></i><b>14.1.4</b> Model evaluation</a></li>
<li class="chapter" data-level="14.1.5" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#study-summary-1"><i class="fa fa-check"></i><b>14.1.5</b> Study summary</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#implementing-the-study-in-r"><i class="fa fa-check"></i><b>14.2</b> Implementing the study in R</a><ul>
<li class="chapter" data-level="14.2.1" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#cohort-instantiation-1"><i class="fa fa-check"></i><b>14.2.1</b> Cohort instantiation</a></li>
<li class="chapter" data-level="14.2.2" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#data-extraction-1"><i class="fa fa-check"></i><b>14.2.2</b> Data extraction</a></li>
<li class="chapter" data-level="14.2.3" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#additional-inclusion-criteria"><i class="fa fa-check"></i><b>14.2.3</b> Additional inclusion criteria</a></li>
<li class="chapter" data-level="14.2.4" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#model-development"><i class="fa fa-check"></i><b>14.2.4</b> Model Development</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#implementing-the-study-in-atlas"><i class="fa fa-check"></i><b>14.3</b> Implementing the study in ATLAS</a></li>
<li class="chapter" data-level="14.4" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#internal-validation"><i class="fa fa-check"></i><b>14.4</b> Internal validation</a><ul>
<li class="chapter" data-level="14.4.1" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#discrimination"><i class="fa fa-check"></i><b>14.4.1</b> Discrimination</a></li>
<li class="chapter" data-level="14.4.2" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#calibration"><i class="fa fa-check"></i><b>14.4.2</b> Calibration</a></li>
<li class="chapter" data-level="14.4.3" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#smooth-calibration"><i class="fa fa-check"></i><b>14.4.3</b> Smooth Calibration</a></li>
<li class="chapter" data-level="14.4.4" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#preference-distribution"><i class="fa fa-check"></i><b>14.4.4</b> Preference distribution</a></li>
<li class="chapter" data-level="14.4.5" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#predicted-probability-distribution"><i class="fa fa-check"></i><b>14.4.5</b> Predicted probability distribution</a></li>
<li class="chapter" data-level="14.4.6" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#test-train-similarity"><i class="fa fa-check"></i><b>14.4.6</b> Test-Train similarity</a></li>
<li class="chapter" data-level="14.4.7" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#variable-scatter-plot"><i class="fa fa-check"></i><b>14.4.7</b> Variable scatter plot</a></li>
<li class="chapter" data-level="14.4.8" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#precision-recall"><i class="fa fa-check"></i><b>14.4.8</b> Precision recall</a></li>
<li class="chapter" data-level="14.4.9" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#demographic-summary"><i class="fa fa-check"></i><b>14.4.9</b> Demographic summary</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#external-validation"><i class="fa fa-check"></i><b>14.5</b> External validation</a></li>
<li class="chapter" data-level="14.6" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#journal-paper-generation"><i class="fa fa-check"></i><b>14.6</b> Journal paper generation</a></li>
<li class="chapter" data-level="14.7" data-path="PatientLevelPrediction.html"><a href="PatientLevelPrediction.html#excercises-1"><i class="fa fa-check"></i><b>14.7</b> Excercises</a></li>
</ul></li>
<li class="part"><span><b>IV Evidence Quality</b></span></li>
<li class="chapter" data-level="15" data-path="EvidenceQuality.html"><a href="EvidenceQuality.html"><i class="fa fa-check"></i><b>15</b> Evidence Quality</a></li>
<li class="chapter" data-level="16" data-path="DataQuality.html"><a href="DataQuality.html"><i class="fa fa-check"></i><b>16</b> Data Quality</a><ul>
<li class="chapter" data-level="16.1" data-path="DataQuality.html"><a href="DataQuality.html#introduction"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="DataQuality.html"><a href="DataQuality.html#achilles-heel-tool"><i class="fa fa-check"></i><b>16.2</b> Achilles Heel tool</a><ul>
<li class="chapter" data-level="16.2.1" data-path="DataQuality.html"><a href="DataQuality.html#precomputed-analyses"><i class="fa fa-check"></i><b>16.2.1</b> Precomputed Analyses</a></li>
<li class="chapter" data-level="16.2.2" data-path="DataQuality.html"><a href="DataQuality.html#example-dq-check"><i class="fa fa-check"></i><b>16.2.2</b> Example DQ check</a></li>
<li class="chapter" data-level="16.2.3" data-path="DataQuality.html"><a href="DataQuality.html#overview-of-existing-dq-heel-checks"><i class="fa fa-check"></i><b>16.2.3</b> Overview of existing DQ Heel checks</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="DataQuality.html"><a href="DataQuality.html#study-specific-checks"><i class="fa fa-check"></i><b>16.3</b> Study-specific checks</a><ul>
<li class="chapter" data-level="16.3.1" data-path="DataQuality.html"><a href="DataQuality.html#outcomes"><i class="fa fa-check"></i><b>16.3.1</b> Outcomes</a></li>
<li class="chapter" data-level="16.3.2" data-path="DataQuality.html"><a href="DataQuality.html#laboratory-data"><i class="fa fa-check"></i><b>16.3.2</b> Laboratory data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ClinicalValidity.html"><a href="ClinicalValidity.html"><i class="fa fa-check"></i><b>17</b> Clinical Validity</a></li>
<li class="chapter" data-level="18" data-path="SoftwareValidity.html"><a href="SoftwareValidity.html"><i class="fa fa-check"></i><b>18</b> Software Validity</a><ul>
<li class="chapter" data-level="18.1" data-path="SoftwareValidity.html"><a href="SoftwareValidity.html#software-development-process"><i class="fa fa-check"></i><b>18.1</b> Software Development Process</a><ul>
<li class="chapter" data-level="18.1.1" data-path="SoftwareValidity.html"><a href="SoftwareValidity.html#source-code-management"><i class="fa fa-check"></i><b>18.1.1</b> Source Code Management</a></li>
<li class="chapter" data-level="18.1.2" data-path="SoftwareValidity.html"><a href="SoftwareValidity.html#documentation"><i class="fa fa-check"></i><b>18.1.2</b> Documentation</a></li>
<li class="chapter" data-level="18.1.3" data-path="SoftwareValidity.html"><a href="SoftwareValidity.html#availability-of-current-and-historical-archive-versions"><i class="fa fa-check"></i><b>18.1.3</b> Availability of Current and Historical Archive Versions</a></li>
<li class="chapter" data-level="18.1.4" data-path="SoftwareValidity.html"><a href="SoftwareValidity.html#maintenance-support-and-retirement"><i class="fa fa-check"></i><b>18.1.4</b> Maintenance, Support and Retirement</a></li>
<li class="chapter" data-level="18.1.5" data-path="SoftwareValidity.html"><a href="SoftwareValidity.html#qualified-personnel"><i class="fa fa-check"></i><b>18.1.5</b> Qualified Personnel</a></li>
<li class="chapter" data-level="18.1.6" data-path="SoftwareValidity.html"><a href="SoftwareValidity.html#physical-and-logical-security"><i class="fa fa-check"></i><b>18.1.6</b> Physical and Logical Security</a></li>
<li class="chapter" data-level="18.1.7" data-path="SoftwareValidity.html"><a href="SoftwareValidity.html#disaster-recovery"><i class="fa fa-check"></i><b>18.1.7</b> Disaster Recovery</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="SoftwareValidity.html"><a href="SoftwareValidity.html#testing"><i class="fa fa-check"></i><b>18.2</b> Testing</a><ul>
<li class="chapter" data-level="18.2.1" data-path="SoftwareValidity.html"><a href="SoftwareValidity.html#unit-test"><i class="fa fa-check"></i><b>18.2.1</b> Unit test</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="SoftwareValidity.html"><a href="SoftwareValidity.html#conclusions"><i class="fa fa-check"></i><b>18.3</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="MethodValidity.html"><a href="MethodValidity.html"><i class="fa fa-check"></i><b>19</b> Method Validity</a><ul>
<li class="chapter" data-level="19.1" data-path="MethodValidity.html"><a href="MethodValidity.html#design-specific-diagnostics"><i class="fa fa-check"></i><b>19.1</b> Design-specific diagnostics</a><ul>
<li class="chapter" data-level="19.1.1" data-path="MethodValidity.html"><a href="MethodValidity.html#diagnostics-for-cohort-method"><i class="fa fa-check"></i><b>19.1.1</b> Diagnostics for cohort method</a></li>
<li class="chapter" data-level="19.1.2" data-path="MethodValidity.html"><a href="MethodValidity.html#diagnostics-for-sccs"><i class="fa fa-check"></i><b>19.1.2</b> Diagnostics for SCCS</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="MethodValidity.html"><a href="MethodValidity.html#diagnostics-for-all-estimation"><i class="fa fa-check"></i><b>19.2</b> Diagnostics for all estimation</a><ul>
<li class="chapter" data-level="19.2.1" data-path="MethodValidity.html"><a href="MethodValidity.html#negative-and-positive-controls"><i class="fa fa-check"></i><b>19.2.1</b> Negative and positive controls</a></li>
<li class="chapter" data-level="19.2.2" data-path="MethodValidity.html"><a href="MethodValidity.html#metrics"><i class="fa fa-check"></i><b>19.2.2</b> Metrics</a></li>
<li class="chapter" data-level="19.2.3" data-path="MethodValidity.html"><a href="MethodValidity.html#empirical-calibration"><i class="fa fa-check"></i><b>19.2.3</b> Empirical calibration</a></li>
<li class="chapter" data-level="19.2.4" data-path="MethodValidity.html"><a href="MethodValidity.html#replication-across-sites"><i class="fa fa-check"></i><b>19.2.4</b> Replication across sites</a></li>
<li class="chapter" data-level="19.2.5" data-path="MethodValidity.html"><a href="MethodValidity.html#sensitivity-analyses"><i class="fa fa-check"></i><b>19.2.5</b> Sensitivity analyses</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="MethodValidity.html"><a href="MethodValidity.html#diagnostics-for-all-prediction"><i class="fa fa-check"></i><b>19.3</b> Diagnostics for all prediction</a></li>
<li class="chapter" data-level="19.4" data-path="MethodValidity.html"><a href="MethodValidity.html#method-validation-in-practice"><i class="fa fa-check"></i><b>19.4</b> Method validation in practice</a></li>
<li class="chapter" data-level="19.5" data-path="MethodValidity.html"><a href="MethodValidity.html#advanced-ohdsi-methods-benchmark"><i class="fa fa-check"></i><b>19.5</b> Advanced: OHDSI Methods Benchmark</a></li>
</ul></li>
<li class="part"><span><b>V OHDSI Studies</b></span></li>
<li class="chapter" data-level="20" data-path="StudySteps.html"><a href="StudySteps.html"><i class="fa fa-check"></i><b>20</b> Study steps</a></li>
<li class="chapter" data-level="21" data-path="NetworkResearch.html"><a href="NetworkResearch.html"><i class="fa fa-check"></i><b>21</b> OHDSI Network Research</a><ul>
<li class="chapter" data-level="21.1" data-path="NetworkResearch.html"><a href="NetworkResearch.html#ohdsi-network-study-examples"><i class="fa fa-check"></i><b>21.1</b> OHDSI Network Study Examples</a><ul>
<li class="chapter" data-level="21.1.1" data-path="NetworkResearch.html"><a href="NetworkResearch.html#endometriosis-study"><i class="fa fa-check"></i><b>21.1.1</b> Endometriosis study</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="NetworkResearch.html"><a href="NetworkResearch.html#excercises-2"><i class="fa fa-check"></i><b>21.2</b> Excercises</a><ul>
<li class="chapter" data-level="21.2.1" data-path="NetworkResearch.html"><a href="NetworkResearch.html#defining-a-cohort"><i class="fa fa-check"></i><b>21.2.1</b> Defining a cohort</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="Glossary.html"><a href="Glossary.html"><i class="fa fa-check"></i><b>A</b> Glossary</a></li>
<li class="chapter" data-level="B" data-path="CohortDefinitions.html"><a href="CohortDefinitions.html"><i class="fa fa-check"></i><b>B</b> Cohort definitions</a><ul>
<li class="chapter" data-level="B.1" data-path="CohortDefinitions.html"><a href="CohortDefinitions.html#AceInhibitors"><i class="fa fa-check"></i><b>B.1</b> ACE inhibitors</a></li>
<li class="chapter" data-level="B.2" data-path="CohortDefinitions.html"><a href="CohortDefinitions.html#AceInhibitorsMono"><i class="fa fa-check"></i><b>B.2</b> New users of ACE inhibitors as first-line monotherapy for hypertension</a></li>
<li class="chapter" data-level="B.3" data-path="CohortDefinitions.html"><a href="CohortDefinitions.html#Ami"><i class="fa fa-check"></i><b>B.3</b> Acute myocardial infarction (AMI)</a></li>
<li class="chapter" data-level="B.4" data-path="CohortDefinitions.html"><a href="CohortDefinitions.html#Angioedema"><i class="fa fa-check"></i><b>B.4</b> Angioedema</a></li>
<li class="chapter" data-level="B.5" data-path="CohortDefinitions.html"><a href="CohortDefinitions.html#ThiazidesMono"><i class="fa fa-check"></i><b>B.5</b> New users of Thiazide-like diuretics as first-line monotherapy for hypertension</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Book of OHDSI</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="PopulationLevelEstimation" class="section level1">
<h1><span class="header-section-number">Chapter 13</span> Population-level estimation</h1>
<p><em>Chapter leads: Martijn Schuemie, David Madigan &amp; Marc Suchard</em></p>
<p>Observational healthcare data, such as administrative claims and electronic health records, offer opportunities to generate real-world evidence about the effect of treatments that can meaningfully improve the lives of patients. In this chapter we focus on population-level effect estimation, that is, the estimation of average causal effects of medical interventions on specific health outcomes of interest. In what follows, we consider two different estimation tasks:</p>
<ul>
<li><strong>Direct effect estimation</strong>: estimating the effect of an exposure on the risk of an outcome, as compared to no exposure.</li>
<li><strong>Comparative effect estimation</strong>: estimation the effect of one exposure (the target exposure) on the risk of an outcome, as compared to another exposure (the comparator exposure).</li>
</ul>
<p>In both cases, the patient-level causal effect contrasts a factual outcome, i.e., what happened to the exposed patient, with a counterfactual outcome, i.e., what would have happened had the exposure not occurred (direct) or had a different exposure occurred (comparative). Since any one patient reveals only the factual outcome (the fundamental problem of causal inference), the various effect estimation methods employ analytic devices to shed light on the counterfactual outcomes.</p>
<p>Use-cases for population-level effect estimation include treatment selection, safety surveillance, and comparative effectiveness. Methods can test specific hypotheses one-at-a-time (e.g. ‘signal evaluation’) or explore multiple-hypotheses-at-once (e.g. ‘signal detection’). In all cases, the objective remains the same: to produce a high-quality estimate of the causal effect.</p>
<div id="study-designs" class="section level2">
<h2><span class="header-section-number">13.1</span> Study designs</h2>
<p>Several different study designs can be used to estimate treatment effects. The main difference between these is how they construct the (unobserved) counterfactual. Below is a brief discussion of the most commonly used designs, all of which are implemented as R packages in the <a href="https://ohdsi.github.io/MethodsLibrary/">OHDSI Methods Library</a>.</p>
<div id="cohort-method" class="section level3">
<h3><span class="header-section-number">13.1.1</span> Cohort method</h3>
<div class="figure" style="text-align: center"><span id="fig:cohortMethod"></span>
<img src="images/PopulationLevelEstimation/cohortMethod.png" alt="The new-user cohort design. Subjects observed to initiate the target treatment are compared to those initiating the comparator treatment. To adjust for differences between the two treatment groups several adjustment strategies can be used, such as stratification, matching, or weighting by the propensity score, or by adding baseline characateristcs to the outcome model. The chararacteristics included in the propensity model or outcome model are captured prior to treatment initiation." width="90%" />
<p class="caption">
Figure 13.1: The new-user cohort design. Subjects observed to initiate the target treatment are compared to those initiating the comparator treatment. To adjust for differences between the two treatment groups several adjustment strategies can be used, such as stratification, matching, or weighting by the propensity score, or by adding baseline characateristcs to the outcome model. The chararacteristics included in the propensity model or outcome model are captured prior to treatment initiation.
</p>
</div>
<p>The new-user cohort method attempts to emulate a randomized clinical trial <span class="citation">(Hernan and Robins <a href="#ref-hernan_2016">2016</a>)</span>. Subjects that are observed to initiate one treatment (the target) are compared to subjects initiating another treatment (the comparator) and are followed for a specific amount of time following treatment initiation, for example the time they stay on the treatment. We can specify the questions we wish to answer in a cohort study by making the five choices highlighted in Table <a href="PopulationLevelEstimation.html#tab:cmChoices">13.1</a>.</p>
<table>
<caption><span id="tab:cmChoices">Table 13.1: </span> Main design choices in a comparative cohort design.</caption>
<colgroup>
<col width="24%" />
<col width="75%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Choice</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Target cohort</td>
<td align="left">A cohort representing the target treatment</td>
</tr>
<tr class="even">
<td align="left">Comparator cohort</td>
<td align="left">A cohort representing the comparator treatment</td>
</tr>
<tr class="odd">
<td align="left">Outcome cohort</td>
<td align="left">A cohort representing the outcome of interest</td>
</tr>
<tr class="even">
<td align="left">Time-at-risk</td>
<td align="left">At what time (often relative to the target and comparator cohort start and end dates) do we consider the risk of the outcome?</td>
</tr>
<tr class="odd">
<td align="left">Model</td>
<td align="left">The model used to estimate the effect while adjusting for differences between the target and comparator</td>
</tr>
</tbody>
</table>
<p>The choice of model specifies, amongst others, the type of model. For example, we could use a logistic regression, which evaluates whether or not the outcome has occurred, and produces an odds ratio. A logistic regression assumes the time-at-risk is of the same length for both target and comparator, or irrelevant. Alternatively, we could choose a Poisson regression which estimates the incidence rate ratio, assuming a constant incidence rate. Often a Cox regression is used which considers time to first outcome to estimate the hazard ratio, assuming proportional hazards.</p>
<p>One crucial difference with a randomized trial is that there is no randomization, and therefore there might be systematic differences between the target and comparator populations. Without adjusting for these differences, estimates are likely to be confounded. A popular mechanism for adjusting for confounding is the use of Propensity Scores (PS). The PS is the probability of a subject receiving one treatment instead of the other, conditional on baseline characteristics. <span class="citation">(P. Rosenbaum and Rubin <a href="#ref-rosenbaum_1983">1983</a>)</span> First, a model – typically a logistic regression – is fitted using the observed treatment assignments (target or comparator), then the model is used to produce the PS for each subject. In the past, PS were computed based on manually selected characteristics, and although the CohortMethod package can support such practices, we prefer the use of large-scale regularized regression using many generic characteristics. <span class="citation">(Tian, Schuemie, and Suchard <a href="#ref-tian_2018">2018</a>)</span> These characteristics include demographics, as well as all diagnoses, drug exposures, measurement, and medical procedures observed prior to treatment initiation, and exclude the target and comparator treatment. A model typically involves 10,000 to 100,000 unique characteristics. The PS can be used in several ways, for example by stratifying the study population based on the PS, by matching target subjects to comparator subjects with similar PS, or by weighting subjects using Inverse Probability of Treatment Weighting (IPTW) derived from the PS. Another strategy for adjusting for differences between the two groups is to include additional variables in the outcome model. One major limitation of this approach is that whereas there often is a wealth of data to fit a propensity model, with thousands of people in both treatment groups, the outcomes we study tend to be somewhat rare, causing a paucity of data when trying to fit elaborate models with the outcome as dependent variable. One approach is to use both a PS and add the same variables that were used in the propensity model in the outcome model, thus adjusting for the same variables twice, but in different ways. The new-user cohort method inherently is a method for comparative effect estimation, comparing one treatment to another. It is difficult to use this method to compare a treatment against no treatment, since it is hard to define a group of unexposed people that is comparable with the exposed group. If one wants to use this design for direct effect estimation, the preferred way is to select a comparator treatment for the same indication as the exposure of interest, where the comparator treatment is believed to have no effect on the outcome. Unfortunately, such a comparator might not always be available.</p>
</div>
<div id="self-controlled-cohort" class="section level3">
<h3><span class="header-section-number">13.1.2</span> Self-controlled cohort</h3>
<div class="figure" style="text-align: center"><span id="fig:scc"></span>
<img src="images/PopulationLevelEstimation/selfControlledCohort.png" alt="The self-controlled cohort design. The rate of outcomes during exposure to the target is compared to the rate of outcomes in the time pre-exposure." width="90%" />
<p class="caption">
Figure 13.2: The self-controlled cohort design. The rate of outcomes during exposure to the target is compared to the rate of outcomes in the time pre-exposure.
</p>
</div>
<p>The self-controlled cohort (SCC) design <span class="citation">(P. B. Ryan, Schuemie, and Madigan <a href="#ref-ryan_2013">2013</a>)</span> compares the rate of outcomes during exposure to the rate of outcomes in the time just prior to the exposure. The four choices shown in Table <a href="PopulationLevelEstimation.html#tab:sccChoices">13.2</a> define a self-controlled cohort question.</p>
<table>
<caption><span id="tab:sccChoices">Table 13.2: </span> Main design choices in a self-controlled cohort design.</caption>
<colgroup>
<col width="24%" />
<col width="75%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Choice</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Target cohort</td>
<td align="left">A cohort representing the treatment</td>
</tr>
<tr class="even">
<td align="left">Outcome cohort</td>
<td align="left">A cohort representing the outcome of interest</td>
</tr>
<tr class="odd">
<td align="left">Time-at-risk</td>
<td align="left">At what time (often relative to the target cohort start and end dates) do we consider the risk of the outcome?</td>
</tr>
<tr class="even">
<td align="left">Control time</td>
<td align="left">The time period used as the control time</td>
</tr>
</tbody>
</table>
<p>Because the same subject that make up the exposed group are also used as the control group, no adjustment for between-person differences need to be made. However, the method is vulnerable to other differences, such as differences between different time periods.</p>
</div>
<div id="case-control" class="section level3">
<h3><span class="header-section-number">13.1.3</span> Case-control</h3>
<div class="figure" style="text-align: center"><span id="fig:caseControl"></span>
<img src="images/PopulationLevelEstimation/caseControl.png" alt="The case-control design. Subjects with the outcome (‘cases’) are compared to subjects without the outcome (‘controls’) in terms of their exposure status. Often, cases and controls are matched on various characteristics such as age and sex." width="90%" />
<p class="caption">
Figure 13.3: The case-control design. Subjects with the outcome (‘cases’) are compared to subjects without the outcome (‘controls’) in terms of their exposure status. Often, cases and controls are matched on various characteristics such as age and sex.
</p>
</div>
<p>Case-control <span class="citation">(Vandenbroucke and Pearce <a href="#ref-vandenbroucke_2012">2012</a>)</span> studies consider the question “are persons with a specific disease outcome exposed more frequently to a specific agent than those without the disease?” Thus, the central idea is to compare “cases”, i.e., subjects that experience the outcome of interest with “controls”, i.e., subjects that did not experience the outcome of interest. The choices in Table <a href="PopulationLevelEstimation.html#tab:ccChoices">13.3</a> define a case-control question.</p>
<table>
<caption><span id="tab:ccChoices">Table 13.3: </span> Main design choices in a case-control design.</caption>
<colgroup>
<col width="24%" />
<col width="75%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Choice</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Outcome cohort</td>
<td align="left">A cohort representing the cases (the outcome of interest)</td>
</tr>
<tr class="even">
<td align="left">Control selection</td>
<td align="left">A strategy for selecting controls and their index date</td>
</tr>
<tr class="odd">
<td align="left">Target cohort</td>
<td align="left">A cohort representing the treatment</td>
</tr>
<tr class="even">
<td align="left">[Nesting cohort]</td>
<td align="left">Optionally, a cohort defining the subpopulation from which cases and controls are drawn</td>
</tr>
<tr class="odd">
<td align="left">Time-at-risk</td>
<td align="left">At what time (often relative to the index date) do we consider exposure status?</td>
</tr>
</tbody>
</table>
<p>Often, one matches controls to cases based on characteristics such as age and sex to make them more comparable. Another widespread practice is to nest the analysis within a specific subgroup of people, for example people that have all been diagnosed with one of the indications of the exposure of interest.</p>
</div>
<div id="case-crossover" class="section level3">
<h3><span class="header-section-number">13.1.4</span> Case-crossover</h3>
<div class="figure" style="text-align: center"><span id="fig:caseCrossover"></span>
<img src="images/PopulationLevelEstimation/caseCrossover.png" alt="The case-crossover design. The time around the outcome is compared to a control date set at a predefined interval prior to the outcome date." width="90%" />
<p class="caption">
Figure 13.4: The case-crossover design. The time around the outcome is compared to a control date set at a predefined interval prior to the outcome date.
</p>
</div>
<p>The case-crossover <span class="citation">(Maclure <a href="#ref-maclure_1991">1991</a>)</span> design evaluates whether the rate of exposure is different at the time of the outcome than at some predefined number of days prior to the outcome. It is trying to determine whether there is something special about the day the outcome occurred. Table <a href="PopulationLevelEstimation.html#tab:ccrChoices">13.4</a> shows the choices that define a case-crosover question:</p>
<table>
<caption><span id="tab:ccrChoices">Table 13.4: </span> Main design choices in a case-crossover design.</caption>
<colgroup>
<col width="24%" />
<col width="75%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Choice</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Outcome cohort</td>
<td align="left">A cohort representing the cases (the outcome of interest)</td>
</tr>
<tr class="even">
<td align="left">Target cohort</td>
<td align="left">A cohort representing the treatment</td>
</tr>
<tr class="odd">
<td align="left">Time-at-risk</td>
<td align="left">At what time (often relative to the index date) do we consider exposure status?</td>
</tr>
<tr class="even">
<td align="left">Control time</td>
<td align="left">The time period used as the control time</td>
</tr>
</tbody>
</table>
<p>Since cases serve as their own control, it is a self-controlled design, and should therefore be robust to confounding due to between-person differences. One concern is that, because the outcome date is always later than the control date, the method will be positively biased if the overall frequency of exposure increases over time (or negatively biased if there is a decrease). To address this, the case-time-control design <span class="citation">(Suissa <a href="#ref-suissa_1995">1995</a>)</span> was developed, which adds matched controls to the case-crossover design to adjust for exposure trends.</p>
</div>
<div id="self-controlled-case-series" class="section level3">
<h3><span class="header-section-number">13.1.5</span> Self-controlled case series</h3>
<div class="figure" style="text-align: center"><span id="fig:selfControlledCaseSeries"></span>
<img src="images/PopulationLevelEstimation/selfControlledCaseSeries.png" alt="The Self-Controlled Case Series design. The rate of outcomes during exposure is compared to the rate of outcomes when not exposed." width="90%" />
<p class="caption">
Figure 13.5: The Self-Controlled Case Series design. The rate of outcomes during exposure is compared to the rate of outcomes when not exposed.
</p>
</div>
<p>The Self-Controlled Case Series (SCCS) design <span class="citation">(C. P. Farrington <a href="#ref-farrington_1995">1995</a>,whitaker_2006)</span> compares the rate of outcomes during exposure to the rate of outcomes during all unexposed time, both before, between, and after exposures. It is a Poisson regression that is conditioned on the person. Thus, it seeks to answer the question: “Given that a patient has the outcome, is the outcome more likely during exposed time compared to non-exposed time?”. The choices in Table <a href="PopulationLevelEstimation.html#tab:sccsChoices">13.5</a> define an SCCS question.</p>
<table>
<caption><span id="tab:sccsChoices">Table 13.5: </span> Main design choices in a self-controlled case series design.</caption>
<colgroup>
<col width="24%" />
<col width="75%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Choice</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Target cohort</td>
<td align="left">A cohort representing the treatment</td>
</tr>
<tr class="even">
<td align="left">Outcome cohort</td>
<td align="left">A cohort representing the outcome of interest</td>
</tr>
<tr class="odd">
<td align="left">Time-at-risk</td>
<td align="left">At what time (often relative to the target cohort start and end dates) do we consider the risk of the outcome?</td>
</tr>
<tr class="even">
<td align="left">Model</td>
<td align="left">The model to estimate the effect, including any adjustments for time-varying confounders</td>
</tr>
</tbody>
</table>
<p>Like other self-controlled designs, the SCCS is robust to confounding due to between-person differences, but vulnerable to confounding due to time-varying effects. Several adjustments are possible to attempt to account for these, for example by including age and season. A special variant of the SCCS includes not just the exposure of interest, but all other exposures to drugs recorded in the database <span class="citation">(S. E. Simpson et al. <a href="#ref-simpson_2013">2013</a>)</span>, potentially adding thousands of additional variables to the model. L1-regularization using cross-validation to select the regularization hyperparameter is applied to the coefficients of all exposures except the exposure of interest.</p>
<p>One important assumption underlying the SCCS is that the observation period end is independent of the date of the outcome. Because for some outcomes, especially ones that can be fatal such as stroke, this assumption can be violated an extension to the SCCS has been developed that corrects for any such dependency. <span class="citation">(C. Paddy Farrington et al. <a href="#ref-farrington_2011">2011</a>)</span></p>
</div>
</div>
<div id="designing-a-hypertension-study" class="section level2">
<h2><span class="header-section-number">13.2</span> Designing a hypertension study</h2>
<div id="problem-definition" class="section level3">
<h3><span class="header-section-number">13.2.1</span> Problem definition</h3>
<p>ACE inhibitors are widely used in patients with hypertension or ischemic heart disease, especially those with other comorbidities such as congestive heart failure, diabetes mellitus, or chronic kidney disease <span class="citation">(Zaman, Oparil, and Calhoun <a href="#ref-zaman_2002">2002</a>)</span>. Angioedema, a serious and sometimes life-threatening adverse event that usually manifests as swelling of the lips, tongue, mouth, larynx, pharynx, or periorbital region, has been linked to the use of these medications <span class="citation">(Sabroe and Black <a href="#ref-sabroe_1997">1997</a>)</span>. However, limited information is available about the absolute and relative risks for angioedema associated with the use of these medications. Existing evidence is primarily based on investigations of specific cohorts (eg, predominantly male veterans or Medicaid beneficiaries), whose findings may not be generalizable to other populations, or based on investigations with few events, which provide unstable risk estimates <span class="citation">(Powers et al. <a href="#ref-powers_2012">2012</a>)</span>. Several observational studies compare ACE inhibitors to beta-blockers for the risk of angioedema <span class="citation">(Magid et al. <a href="#ref-magid_2010">2010</a>; Toh et al. <a href="#ref-toh_2012">2012</a>)</span>, but beta-blockers are no longer recommend as first-line treatment of hypertension <span class="citation">(Whelton et al. <a href="#ref-whelton_2018">2018</a>)</span>. A viable alternative treatment could be thiazides or thiazide-like diuretics, which could be just as effective in managing hypertension and its associated risks such as acute myocardial infarction.</p>
<p>We will apply our population-level estimation framework to observational healthcare data to address the following comparative estimation question:</p>
<blockquote>
<p>What is the risk of angioedema and acute myocaridal infarction in new users of ACE inhibitors compared to new users of thiazide and thiazide-like diuretics?</p>
</blockquote>
</div>
<div id="target-and-comparator" class="section level3">
<h3><span class="header-section-number">13.2.2</span> Target and comparator</h3>
<p>Focus on first-line mono-therapy</p>
</div>
<div id="outcome" class="section level3">
<h3><span class="header-section-number">13.2.3</span> Outcome</h3>
<p>Angioedema and AMI</p>
</div>
<div id="time-at-risk" class="section level3">
<h3><span class="header-section-number">13.2.4</span> Time-at-risk</h3>
</div>
<div id="model" class="section level3">
<h3><span class="header-section-number">13.2.5</span> Model</h3>
</div>
<div id="study-summary" class="section level3">
<h3><span class="header-section-number">13.2.6</span> Study summary</h3>
<table>
<caption><span id="tab:aceChoices">Table 13.6: </span> Main design choices four our comparative cohort study.</caption>
<thead>
<tr class="header">
<th align="left">Choice</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Target cohort</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Comparator cohort</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Outcome cohort</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Time-at-risk</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Model</td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="implementation-the-study-using-atlas" class="section level2">
<h2><span class="header-section-number">13.3</span> Implementation the study using ATLAS</h2>
<p>SPECIFICATION</p>
<p>Comparative Cohort Settings</p>
<div id="specifying-the-comparisons" class="section level3">
<h3><span class="header-section-number">13.3.1</span> Specifying the comparisons</h3>
<blockquote>
<p>Comparative Cohort Settings</p>
</blockquote>
<blockquote>
<p>+Add Comparison</p>
</blockquote>
<p>Click on <img src="images/PopulationLevelEstimation/image20-half.png" />. The window in Figure <a href="#fig:comparions"><strong>??</strong></a> should appear. Then click on <img src="images/PopulationLevelEstimation/image2-half.png" /> to add cohorts to target, comparator and outcome cohort.</p>
<div class="figure" style="text-align: center"><span id="fig:comparisons"></span>
<img src="images/PopulationLevelEstimation/image5.png" alt="The comparison window." width="100%" />
<p class="caption">
Figure 13.6: The comparison window.
</p>
</div>
<blockquote>
<p>Comparison: Add or update the target, comparator, outcome(s) cohorts and negative control outcomes</p>
</blockquote>
<p>When specifying T, C, and O, note that you can select as many T, C, and O cohorts as you like–this means that you can do many comparisons simultaneously. Additional outcomes will appear in the table below the <img src="images/PopulationLevelEstimation/image11-half.png" /> button. These will be listed in a table with ID and Name columns displayed. Many entries can be displayed in this table.</p>
<blockquote>
<p>Choose your negative control outcomes</p>
</blockquote>
<p>Pick concept sets you want to include by clicking on <img src="images/PopulationLevelEstimation/image2-half.png" />. Search for the negative control concept sets you previously built as discused in Chapter <a href="MethodValidity.html#MethodValidity">19</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:negControls"></span>
<img src="images/PopulationLevelEstimation/image3.png" alt="Negative control outcomes selection window." width="100%" />
<p class="caption">
Figure 13.7: Negative control outcomes selection window.
</p>
</div>
<p>Note: The negative controls concept IDs included in the concept set do not include their descendants. Figure <a href="PopulationLevelEstimation.html#fig:ncConceptSet">13.8</a> shows the negative control concept set used in this example.</p>
<div class="figure" style="text-align: center"><span id="fig:ncConceptSet"></span>
<img src="images/PopulationLevelEstimation/image14.png" alt="Negative Control concept set." width="100%" />
<p class="caption">
Figure 13.8: Negative Control concept set.
</p>
</div>
<blockquote>
<p>What concepts do you want to include in baseline covariates in the propensity score model? (Leave blank if you want to include everything)</p>
</blockquote>
<p>Here, you can specify exactly which covariates you would like to include in your propensity score model. When specifying covariates <em>here</em>, all other covariates (aside from those you specified) are left out. We usually want to include all baseline covariates, letting the LASSO regression build a model that balances all covariates. You might want to specify particular covariates when you are replicating an existing study that manually picked a small number of covariates. These inclusions can be specified in this comparison section or in the analysis section. The option in the analysis section of whether or not to include descendants will apply also here in the comparison section.</p>
<blockquote>
<p>What concepts do you want to exclude from baseline covariates in the propensity score model? (Leave blank if you want to include everything)</p>
</blockquote>
<p>Rather than specifying which covariates to include, we can instead specify covariates to <em>exclude</em>. When we submit a list of concept IDs in this field, we use every covariate except for those that we submitted. We will want to exclude covariates that are very highly correlated with the exposures or else the propensity model will separate the two groups nearly perfectly, making a comparison impossible. These exclusions can be specified in this comparison section or in the analysis section. Exclusions may be comparison specific (exposure drugs), so it often makes sense to specify them here. The option in the analysis section of whether or not to include descendants will apply also here in the comparison section.</p>
<p>In this example, the covariates we want to exclude are ACE inhibitors and thiazides or thiazide diuretic. Figure <a href="PopulationLevelEstimation.html#fig:covsToExclude">13.9</a> shows we select a concept set that includes all these concepts.</p>
<div class="figure" style="text-align: center"><span id="fig:covsToExclude"></span>
<img src="images/PopulationLevelEstimation/image8.png" alt="Covariate selection window with exclusion concepts." width="100%" />
<p class="caption">
Figure 13.9: Covariate selection window with exclusion concepts.
</p>
</div>
<p>Often we want to include or exclude concepts <strong>and their descendants</strong>. We could specify the concept set to include descendant concepts. However, for various reasons it might be more efficient to not include descendant in the concept set, but rather automatically add them by setting the ‘Should descendant concepts be added’ option to <em>yes</em> in the Covariate Settings section of the Analysis settings that will be discussed later.</p>
<div class="figure" style="text-align: center"><span id="fig:covsConceptSet"></span>
<img src="images/PopulationLevelEstimation/image14.png" alt="The concept set defining the concepts to exclude. Note that no descendantsa have been included. We will specify to include these at analysis time in the Analysis settings." width="100%" />
<p class="caption">
Figure 13.10: The concept set defining the concepts to exclude. Note that no descendantsa have been included. We will specify to include these at analysis time in the Analysis settings.
</p>
</div>
</div>
</div>
<div id="implementation-the-study-using-r" class="section level2">
<h2><span class="header-section-number">13.4</span> Implementation the study using R</h2>
<p>Now we have completely designed our study we have to implement the study. This will be done using the <a href="https://ohdsi.github.io/CohortMethod/">CohortMethod</a> package to execute our study. It extracts the necessary data from a database in the CDM and can use a large set of covariates for the propensity model.</p>
<div id="cohort-instantiation" class="section level3">
<h3><span class="header-section-number">13.4.1</span> Cohort instantiation</h3>
<p>We first need to instantiate the target and outcome cohorts. Instantiating cohorts is described in Chapter <a href="Cohorts.html#Cohorts">11</a>. The Appendix provides the full definitions of the target (Appendix <a href="CohortDefinitions.html#AceInhibitors">B.1</a>) and outcome (Appendix <a href="CohortDefinitions.html#Angioedema">B.4</a>) cohorts. In this example we will assume the ACE inhibitors cohort has ID 1, and the angioedema cohort has ID 2.</p>
</div>
<div id="data-extraction" class="section level3">
<h3><span class="header-section-number">13.4.2</span> Data extraction</h3>
<p>We first need to tell R how to connect to the server. <a href="https://ohdsi.github.io/CohortMethod/"><code>CohortMethod</code></a> uses the <a href="https://ohdsi.github.io/DatabaseConnector/"><code>DatabaseConnector</code></a> package, which provides a function called <code>createConnectionDetails</code>. Type <code>?createConnectionDetails</code> for the specific settings required for the various database management systems (DBMS). For example, one might connect to a PostgreSQL database using this code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(PatientLevelPrediction)
connDetails &lt;-<span class="st"> </span><span class="kw">createConnectionDetails</span>(<span class="dt">dbms =</span> <span class="st">&quot;postgresql&quot;</span>,
                                       <span class="dt">server =</span> <span class="st">&quot;localhost/ohdsi&quot;</span>,
                                       <span class="dt">user =</span> <span class="st">&quot;joe&quot;</span>,
                                       <span class="dt">password =</span> <span class="st">&quot;supersecret&quot;</span>)

cdmDbSchema &lt;-<span class="st"> &quot;my_cdm_data&quot;</span>
cohortsDbSchema &lt;-<span class="st"> &quot;scratch&quot;</span>
cohortsDbTable &lt;-<span class="st"> &quot;my_cohorts&quot;</span>
cdmVersion &lt;-<span class="st"> &quot;5&quot;</span></code></pre></div>
<p>The last four lines define the <code>cdmDbSchema</code>, <code>cohortsDbSchema</code>, and <code>cohortsDbTable</code> variables, as well as the CDM version. We will use these later to tell R where the data in CDM format live, where the cohorts of interest have been created, and what version CDM is used. Note that for Microsoft SQL Server, database schemas need to specify both the database and the schema, so for example <code>cdmDbSchema &lt;- &quot;my_cdm_data.dbo&quot;</code>.</p>
</div>
<div id="specifying-the-analyses" class="section level3">
<h3><span class="header-section-number">13.4.3</span> Specifying the analyses</h3>
</div>
</div>
<div id="excercises" class="section level2">
<h2><span class="header-section-number">13.5</span> Excercises</h2>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-farrington_1995">
<p>Farrington, C. P. 1995. “Relative incidence estimation from case series for vaccine safety evaluation.” <em>Biometrics</em> 51 (1): 228–35.</p>
</div>
<div id="ref-farrington_2011">
<p>Farrington, C. Paddy, Karim Anaya-Izquierdo, Heather J. Whitaker, Mounia N. Hocine, Ian Douglas, and Liam Smeeth. 2011. “Self-Controlled Case Series Analysis with Event-Dependent Observation Periods.” <em>Journal of the American Statistical Association</em> 106 (494). Taylor &amp; Francis: 417–26. doi:<a href="https://doi.org/10.1198/jasa.2011.ap10108">10.1198/jasa.2011.ap10108</a>.</p>
</div>
<div id="ref-hernan_2016">
<p>Hernan, M. A., and J. M. Robins. 2016. “Using Big Data to Emulate a Target Trial When a Randomized Trial Is Not Available.” <em>Am. J. Epidemiol.</em> 183 (8): 758–64.</p>
</div>
<div id="ref-maclure_1991">
<p>Maclure, M. 1991. “The case-crossover design: a method for studying transient effects on the risk of acute events.” <em>Am. J. Epidemiol.</em> 133 (2): 144–53.</p>
</div>
<div id="ref-magid_2010">
<p>Magid, D. J., S. M. Shetterly, K. L. Margolis, H. M. Tavel, P. J. O’Connor, J. V. Selby, and P. M. Ho. 2010. “Comparative effectiveness of angiotensin-converting enzyme inhibitors versus beta-blockers as second-line therapy for hypertension.” <em>Circ Cardiovasc Qual Outcomes</em> 3 (5): 453–58.</p>
</div>
<div id="ref-powers_2012">
<p>Powers, B. J., R. R. Coeytaux, R. J. Dolor, V. Hasselblad, U. D. Patel, W. S. Yancy, R. N. Gray, R. J. Irvine, A. S. Kendrick, and G. D. Sanders. 2012. “Updated report on comparative effectiveness of ACE inhibitors, ARBs, and direct renin inhibitors for patients with essential hypertension: much more data, little new information.” <em>J Gen Intern Med</em> 27 (6): 716–29.</p>
</div>
<div id="ref-rosenbaum_1983">
<p>Rosenbaum, P., and D. Rubin. 1983. “The Central Role of the Propensity Score in Observational Studies for Causal Effects.” <em>Biometrika</em> 70 (April): 41–55. doi:<a href="https://doi.org/10.1093/biomet/70.1.41">10.1093/biomet/70.1.41</a>.</p>
</div>
<div id="ref-ryan_2013">
<p>Ryan, P. B., M. J. Schuemie, and D. Madigan. 2013. “Empirical performance of a self-controlled cohort method: lessons for developing a risk identification and analysis system.” <em>Drug Saf</em> 36 Suppl 1 (October): 95–106.</p>
</div>
<div id="ref-sabroe_1997">
<p>Sabroe, R. A., and A. K. Black. 1997. “Angiotensin-converting enzyme (ACE) inhibitors and angio-oedema.” <em>Br. J. Dermatol.</em> 136 (2): 153–58.</p>
</div>
<div id="ref-simpson_2013">
<p>Simpson, S. E., D. Madigan, I. Zorych, M. J. Schuemie, P. B. Ryan, and M. A. Suchard. 2013. “Multiple self-controlled case series for large-scale longitudinal observational databases.” <em>Biometrics</em> 69 (4): 893–902.</p>
</div>
<div id="ref-suissa_1995">
<p>Suissa, S. 1995. “The case-time-control design.” <em>Epidemiology</em> 6 (3): 248–53.</p>
</div>
<div id="ref-tian_2018">
<p>Tian, Y., M. J. Schuemie, and M. A. Suchard. 2018. “Evaluating large-scale propensity score performance through real-world and synthetic data experiments.” <em>Int J Epidemiol</em> 47 (6): 2005–14.</p>
</div>
<div id="ref-toh_2012">
<p>Toh, S., M. E. Reichman, M. Houstoun, M. Ross Southworth, X. Ding, A. F. Hernandez, M. Levenson, et al. 2012. “Comparative risk for angioedema associated with the use of drugs that target the renin-angiotensin-aldosterone system.” <em>Arch. Intern. Med.</em> 172 (20): 1582–9.</p>
</div>
<div id="ref-vandenbroucke_2012">
<p>Vandenbroucke, J. P., and N. Pearce. 2012. “Case-control studies: basic concepts.” <em>Int J Epidemiol</em> 41 (5): 1480–9.</p>
</div>
<div id="ref-whelton_2018">
<p>Whelton, P. K., R. M. Carey, W. S. Aronow, D. E. Casey, K. J. Collins, C. Dennison Himmelfarb, S. M. DePalma, et al. 2018. “2017 ACC/AHA/AAPA/ABC/ACPM/AGS/APhA/ASH/ASPC/NMA/PCNA Guideline for the Prevention, Detection, Evaluation, and Management of High Blood Pressure in Adults: Executive Summary: A Report of the American College of Cardiology/American Heart Association Task Force on Clinical Practice Guidelines.” <em>Circulation</em> 138 (17): e426–e483.</p>
</div>
<div id="ref-zaman_2002">
<p>Zaman, M. A., S. Oparil, and D. A. Calhoun. 2002. “Drugs targeting the renin-angiotensin-aldosterone system.” <em>Nat Rev Drug Discov</em> 1 (8): 621–36.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Characterization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="PatientLevelPrediction.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/OHDSI/TheBookOfOhdsi/edit/master/PopulationLevelEstimation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["TheBookOfOhdsi.pdf", "TheBookOfOhdsi.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
